name: Analyze Nova Exe

on: workflow_dispatch

jobs:
  analyze:
    runs-on: ubuntu-latest

    steps:
      - name: Download Nova.exe
        run: wget https://github.com/confeden/Nova/releases/download/v0.997/Nova.exe

      - name: Install dependencies
        run: sudo apt-get install -y file binutils

      # 1. Проверяем тип файла
      - name: Check File Type
        run: file Nova.exe

      # 2. Ищем строки, указывающие на Python, Nuitka или .NET
      - name: Search for Signatures
        run: |
          echo "Checking for Python..."
          strings Nova.exe | grep -i "python" | head -n 5 || echo "No Python strings found"
          
          echo "Checking for Nuitka..."
          strings Nova.exe | grep -i "nuitka" | head -n 5 || echo "No Nuitka strings found"
          
          echo "Checking for .NET/C#..."
          strings Nova.exe | grep -i "assembly" | head -n 5 || echo "No .NET strings found"

      # 3. Пробуем распаковать как обычный архив (если это SFX)
      - name: Try 7zip Extraction
        run: 7z x Nova.exe -oextracted_7z || echo "Not a 7zip archive"

      - name: Upload Logs (Optional)
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: analysis-logs
          path: extracted_7z/
